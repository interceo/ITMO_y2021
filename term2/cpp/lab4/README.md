# Лабораторная работа 4 \
Длинная арифметика

В целом фикс ровно один

[Тестер](https://github.com/swerchansky/BigNum-tester)

## **Цель работы**

Изучить особенности работы классами и операторами в C++.


## **Стандарт языка**

C++17 и новее.


## **Описание**

В программе должен быть реализован класс LN, позволяющий выполнять арифметические операции над целыми числами произвольной точности в десятичной системе. С его использованием должна проводиться работа с данными.

**Аргументы программе передаются через командную строку:**


```
cpp2 <имя_входного_файла> <имя_выходного_файла>
```


**Входной файл** содержит выражение в форме обратной польской записи. Каждое число и знак операции (‘+’, ‘-’, ‘*’, ‘/’, ‘%’ – остаток от деления, ‘~’ – квадратный корень, ‘_’ – унарный минус, ‘&lt;’, ‘&lt;=’, ‘>’, ‘>=’, ‘==’, ‘!=’) располагается на отдельной строке. Каждая строка оканчивается символом новой строки.

**Выходной файл** должен содержать состояние стека на момент завершения работы программы. Каждое значение находится на новой строке, начиная с вершины, строка оканчивается символом новой строки.

Результат операций сравнения: 0 (для false) или 1 (для true). Число -0 должно быть полностью эквивалентно 0 (включая вывод).

Реализации операций умножения (оператор ‘*’), деления (оператор ‘/’), остаток от деления (оператор ‘%’) и квадратный корень (‘~’) должны работать с адекватной скоростью (то есть требуется алгоритм уровня “в столбик”, а не “умножение на n путём сложения n раз”).

Квадратный корень и деление округляют к 0. Результат при взятии корня из отрицательного числа или делении на ноль: NaN. Результат арифметических действий и сравнения с NaN: в соответствии со стандартом IEEE-754.

Корректность входных данных гарантируется.

Пример входных и выходных данных:


<table>
  <tr>
   <td><strong>input</strong>
   </td>
   <td><strong>output</strong>
   </td>
  </tr>
  <tr>
   <td>2
<p>
3
<p>
2
<p>
+
<p>
6
<p>
-
<p>
-1
<p>
==
   </td>
   <td>1
<p>
2
   </td>
  </tr>
</table>


Класс должен иметь конструкторы:

●	из long long со значением по умолчанию: 0;

●	из строки символов C (const char *);

●	из строки std::string_view;

●	конструктор копирования;

●	конструктор перемещения.

Для класса должны быть реализованы операторы:

●	оператор копирующего присваивания;

●	оператор перемещающего присваивания;

●	арифметические: +, -, *, /, %, ~, - (унарный);

●	комбинация арифметических операций и присваивания (например, +=);

●	сравнения: &lt;, &lt;=, >, >=, ==, !=;

●	преобразования типа в: long long (с генерацией исключения в случае, когда значение не умещается), bool (неравенство нулю);

●	создания из литерала произвольной длины с суффиксом _ln (например, должно работать выражение: LN x; x = 123_ln;).

Необходимо реализовать вспомогательные функции/методы (сложение, вычитание, универсальное сравнение (возвращает -1, 0, 1)), которые будут использоваться в функциях/методах: оператор ‘+’, оператор ‘&lt;’ и пр. Например, при реализации и оператора ‘+’, и оператора ‘-’ необходимо выполнять и сложение, и вычитание, в зависимости от знаков входных чисел.

**Реализация по файлам**

Объявление класса необходимо поместить в заголовочный файл LN.h, реализация крупных методов (больше 1 строки) класса должна быть в LN.cpp. Код функции main располагается в main.cpp. 

Заголовочные файлы должны быть с защитой от повторного включения. 

Создавать свои файлы со вспомогательным кодом не запрещено.

**Работа с памятью**

Нехватка памяти при операциях с классом должна обрабатываться через **исключения **C++.

**Кол-во перевыделений памяти** в конструкторах и операциях не должно быть порядка длины числа (или больше…).

Использовать **STL ([update] **STL, string или другие стандартные классы с нетривиальными деструкторами = отличными от деструктора, который вы получаете по умолчанию с классом, который ничего не делает, [https://en.cppreference.com/w/cpp/language/destructor#Trivial_destructor](https://en.cppreference.com/w/cpp/language/destructor#Trivial_destructor)**) **внутри класса LN не запрещено, НО оценивается в -5 баллов. Соответственно, можно получить отрицательное кол-во баллов за эту работу в целом.

**Рекомендация по решению**

В классе отдельно хранить знак числа и отдельно разряды числа, при этом разряды рекомендуется хранить массивом, начиная с младшего (digits[0] соответствует самой младшей цифре числа).


## **Требования к программе**

Программа должна:



1. быть написана на C++ по заданному стандарту;
2. выполнять поставленную в ТЗ задачу;
3. не использовать внешние библиотеки;
4. всегда корректно освобождать память;
5. всегда корректно закрывать файлы;
6. обрабатывать ошибки: 
    1. файл не открылся; 
    2. не удалось выделить память;
    3. на вход передано неверное число аргументов командной строки.

    В этих случаях необходимо выдавать сообщение об ошибке и корректно завершаться с ненулевым кодом возврата (см. `"return_codes.h"`);

7. никогда ничего не писать **в поток вывода**;
8. выводить сообщения об ошибке в **поток вывода ошибок**. 


## **Ограничения**



1. Запрещено  использование exit(...) в коде.
2. Запрещено использовать VLA (как массивы, так и указатели), т.к. его нет в стандарте С++.
3. Ограничивается использование глобальных переменных (кроме констант) - необходимость их использования вы должны обосновать на защите. Ваш код должен быть максимально приспособлен к переносимости в другие проекты и/или использованию другими разработчиками.
4. Запрещается подключать системные библиотеки через `#include "..."`.
5. Запрещается использовать setlocale(...). Учимся писать небольшие комментарии пользователю по-английски.
6. Запрещается использовать system(“pause”).
7. Если вы создаёте свои макросы, то их название не должно быть “DEBUG”, “_DEBUG”, “NDEBUG” и прочие, определяемые компиляторами имена.  Допустимы любые другие названия из заглавных букв и символов подчёркивания.

Полезные check-листы и ссылки:



* [Проверки](https://docs.google.com/presentation/d/1uMksPWTNaUMrANDrBzfnypuYTtEnjAriHd0YbYLp44U/edit#slide=id.g11ada5b9098_0_0)
* [Отправка на GitHub](https://docs.google.com/presentation/d/1uMksPWTNaUMrANDrBzfnypuYTtEnjAriHd0YbYLp44U/edit#slide=id.g11f1d6dc113_0_74)
* [Про критерии оценивания](https://docs.google.com/presentation/d/1uMksPWTNaUMrANDrBzfnypuYTtEnjAriHd0YbYLp44U/edit#slide=id.g11f1d6dc113_0_25)
* [Суперпопытка](https://docs.google.com/presentation/d/1uMksPWTNaUMrANDrBzfnypuYTtEnjAriHd0YbYLp44U/edit#slide=id.g11f4cbfa6bb_0_26)   